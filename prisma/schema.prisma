// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model EmailSummary {
  id          String   @id @default(cuid())
  emailId     String   @unique // Gmail message ID
  userId      String   // User email from session
  summary     String
  keyPoints   String   // JSON array stored as string
  actionItems String   // JSON array stored as string
  sentiment   String   // positive/neutral/negative/urgent
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model AIFeedback {
  id           String   @id @default(cuid())
  userId       String
  responseType String   // "summary", "chat", "categorize", "tasks", "filters"
  responseData String   // JSON of the AI response
  context      String?  // Email ID or chat context
  rating       String   // "up" or "down"
  issue        String?  // User-provided issue description (for thumbs down)
  createdAt    DateTime @default(now())
}

model EmailClassification {
  id          String   @id @default(cuid())
  emailId     String   @unique
  userId      String
  category    String   // work, personal, promotions, alerts, urgent, newsletter, etc.
  priority    String   // high, medium, low
  isRedundant Boolean  @default(false)
  redundantOf String?  // Original email ID if redundant
  aiReason    String?
  confidence  Float?
  isManual    Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model UserTag {
  id        String   @id @default(cuid())
  userId    String
  name      String
  color     String   // Hex color
  createdAt DateTime @default(now())

  @@unique([userId, name])
}

model EmailTag {
  id        String   @id @default(cuid())
  emailId   String
  tagId     String
  createdAt DateTime @default(now())

  @@unique([emailId, tagId])
}
